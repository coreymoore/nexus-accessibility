<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Modal Manager Demo</title>
    <link rel="stylesheet" href="modal.css" />
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto",
          sans-serif;
        line-height: 1.6;
        margin: 40px;
        background: #f8f9fa;
      }

      .demo-section {
        background: white;
        padding: 24px;
        border-radius: 8px;
        margin-bottom: 24px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      .demo-button {
        background: #3b82f6;
        color: white;
        border: none;
        padding: 12px 20px;
        border-radius: 6px;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        margin: 8px 8px 8px 0;
        transition: background 0.15s ease;
      }

      .demo-button:hover {
        background: #2563eb;
      }

      .demo-button--secondary {
        background: #6b7280;
      }

      .demo-button--secondary:hover {
        background: #4b5563;
      }

      h1 {
        color: #111827;
        margin-bottom: 8px;
      }

      h2 {
        color: #374151;
        margin-top: 0;
      }

      p {
        color: #6b7280;
        margin-bottom: 16px;
      }

      code {
        background: #f3f4f6;
        padding: 2px 6px;
        border-radius: 4px;
        font-size: 13px;
      }
    </style>
  </head>
  <body>
    <h1>ARIA APG Modal Manager Demo</h1>
    <p>
      This demo shows the accessible modal manager following W3C ARIA Authoring
      Practices Guide patterns.
    </p>

    <div class="demo-section">
      <h2>Basic Modals</h2>
      <button class="demo-button" onclick="showBasicModal()">
        Basic Modal
      </button>
      <button class="demo-button" onclick="showConfirmModal()">
        Confirmation Modal
      </button>
      <button class="demo-button" onclick="showFormModal()">Form Modal</button>
    </div>

    <div class="demo-section">
      <h2>Different Sizes</h2>
      <button class="demo-button" onclick="showSmallModal()">
        Small Modal
      </button>
      <button class="demo-button" onclick="showMediumModal()">
        Medium Modal
      </button>
      <button class="demo-button" onclick="showLargeModal()">
        Large Modal
      </button>
    </div>

    <div class="demo-section">
      <h2>Modal Features</h2>
      <button class="demo-button" onclick="showNoEscapeModal()">
        No Escape Close
      </button>
      <button class="demo-button" onclick="showNoBackdropModal()">
        No Backdrop Close
      </button>
      <button class="demo-button" onclick="showLoadingModal()">
        Loading Modal
      </button>
    </div>

    <div class="demo-section">
      <h2>Accessibility Features</h2>
      <p>
        ✅ <strong>Keyboard Navigation:</strong> Tab and Shift+Tab cycle through
        focusable elements
      </p>
      <p>
        ✅ <strong>Focus Management:</strong> Focus moves to modal when opened,
        returns when closed
      </p>
      <p>
        ✅ <strong>Screen Reader Support:</strong> Proper ARIA attributes and
        announcements
      </p>
      <p>✅ <strong>Escape Key:</strong> Closes modal (unless disabled)</p>
      <p>✅ <strong>Focus Trapping:</strong> Focus stays within modal</p>
      <p>✅ <strong>Background Scroll:</strong> Prevented when modal is open</p>
    </div>

    <script src="modules/modal-manager.js"></script>
    <script>
      // Initialize modal manager
      const modalManager = new ModalManager();
      modalManager.init();

      function showBasicModal() {
        modalManager.createModal("basic", {
          title: "Basic Modal",
          content:
            "<p>This is a basic modal dialog with standard functionality.</p><p>You can use <kbd>Tab</kbd> and <kbd>Shift+Tab</kbd> to navigate, and <kbd>Escape</kbd> to close.</p>",
          buttons: [
            {
              text: "Close",
              type: "primary",
              autoFocus: true,
              onClick: (e, modalId) => modalManager.closeModal(modalId),
            },
          ],
        });
        modalManager.openModal("basic");
      }

      function showConfirmModal() {
        modalManager.createModal("confirm", {
          title: "Confirm Action",
          content:
            "<p>Are you sure you want to proceed with this action?</p><p>This operation cannot be undone.</p>",
          buttons: [
            {
              text: "Cancel",
              type: "secondary",
              onClick: (e, modalId) => modalManager.closeModal(modalId),
            },
            {
              text: "Confirm",
              type: "danger",
              autoFocus: true,
              onClick: (e, modalId) => {
                alert("Action confirmed!");
                modalManager.closeModal(modalId);
              },
            },
          ],
        });
        modalManager.openModal("confirm");
      }

      function showFormModal() {
        modalManager.createModal("form", {
          title: "User Information",
          content: `
                    <form id="userForm">
                        <label for="userName">Name:</label>
                        <input type="text" id="userName" name="name" required>
                        
                        <label for="userEmail">Email:</label>
                        <input type="email" id="userEmail" name="email" required>
                        
                        <label for="userMessage">Message:</label>
                        <textarea id="userMessage" name="message" rows="4"></textarea>
                    </form>
                `,
          buttons: [
            {
              text: "Cancel",
              type: "secondary",
              onClick: (e, modalId) => modalManager.closeModal(modalId),
            },
            {
              text: "Submit",
              type: "primary",
              onClick: (e, modalId) => {
                const form = document.getElementById("userForm");
                if (form.checkValidity()) {
                  alert("Form submitted successfully!");
                  modalManager.closeModal(modalId);
                } else {
                  form.reportValidity();
                }
              },
            },
          ],
        });
        modalManager.openModal("form");
      }

      function showSmallModal() {
        modalManager.createModal("small", {
          title: "Small Modal",
          content: "<p>This is a small modal dialog (400px wide).</p>",
          size: "small",
          buttons: [
            {
              text: "Close",
              type: "primary",
              onClick: (e, modalId) => modalManager.closeModal(modalId),
            },
          ],
        });
        modalManager.openModal("small");
      }

      function showMediumModal() {
        modalManager.createModal("medium", {
          title: "Medium Modal",
          content:
            "<p>This is a medium modal dialog (600px wide). This is the default size.</p>",
          size: "medium",
          buttons: [
            {
              text: "Close",
              type: "primary",
              onClick: (e, modalId) => modalManager.closeModal(modalId),
            },
          ],
        });
        modalManager.openModal("medium");
      }

      function showLargeModal() {
        modalManager.createModal("large", {
          title: "Large Modal",
          content: `
                    <p>This is a large modal dialog (800px wide).</p>
                    <p>It can contain more content and is suitable for complex forms or detailed information.</p>
                    <ul>
                        <li>Feature one</li>
                        <li>Feature two</li>
                        <li>Feature three</li>
                        <li>Feature four</li>
                    </ul>
                `,
          size: "large",
          buttons: [
            {
              text: "Close",
              type: "primary",
              onClick: (e, modalId) => modalManager.closeModal(modalId),
            },
          ],
        });
        modalManager.openModal("large");
      }

      function showNoEscapeModal() {
        modalManager.createModal("no-escape", {
          title: "No Escape Close",
          content:
            "<p>This modal cannot be closed with the Escape key. You must click a button.</p>",
          closeOnEscape: false,
          buttons: [
            {
              text: "Close Modal",
              type: "primary",
              autoFocus: true,
              onClick: (e, modalId) => modalManager.closeModal(modalId),
            },
          ],
        });
        modalManager.openModal("no-escape");
      }

      function showNoBackdropModal() {
        modalManager.createModal("no-backdrop", {
          title: "No Backdrop Close",
          content:
            "<p>This modal cannot be closed by clicking the backdrop. You must click a button or press Escape.</p>",
          closeOnBackdrop: false,
          buttons: [
            {
              text: "Close Modal",
              type: "primary",
              autoFocus: true,
              onClick: (e, modalId) => modalManager.closeModal(modalId),
            },
          ],
        });
        modalManager.openModal("no-backdrop");
      }

      function showLoadingModal() {
        modalManager.createModal("loading", {
          title: "Loading...",
          content: `
                    <div class="modal-loading">
                        <div class="spinner"></div>
                        Processing your request...
                    </div>
                `,
          closeOnEscape: false,
          closeOnBackdrop: false,
          buttons: [],
        });
        modalManager.openModal("loading");

        // Auto-close after 3 seconds
        setTimeout(() => {
          modalManager.setContent("loading", "<p>✅ Processing complete!</p>");
          modalManager.setTitle("loading", "Success");

          // Add close button
          const modal = modalManager.modals.get("loading");
          const footer = modal.element.querySelector(".modal-footer");
          footer.innerHTML = "";

          const closeBtn = document.createElement("button");
          closeBtn.className = "modal-button modal-button--primary";
          closeBtn.textContent = "Close";
          closeBtn.addEventListener("click", () =>
            modalManager.closeModal("loading")
          );
          footer.appendChild(closeBtn);
          closeBtn.focus();
        }, 3000);
      }

      // Listen to modal events
      document.addEventListener("modalOpened", (e) => {
        console.log("Modal opened:", e.detail);
      });

      document.addEventListener("modalClosed", (e) => {
        console.log("Modal closed:", e.detail);
      });
    </script>
  </body>
</html>
