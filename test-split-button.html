<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Popup Test - Split Button</title>
    <link rel="stylesheet" href="src/popup/popup.css" />
    <style>
      body {
        margin: 20px;
        background: #f5f5f5;
      }
      .demo-container {
        background: white;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        max-width: 450px;
        margin: 0 auto;
      }
    </style>
  </head>
  <body>
    <div class="demo-container">
      <h2 style="color: #683ab7; text-align: center; margin-bottom: 20px">
        Split Button Test
      </h2>

      <!-- Alerts CTA message -->
      <div class="alerts-cta-message">
        <p>Create a Report to Scan for Accessibility Alerts</p>
      </div>

      <!-- Mock alerts preview (blurred) -->
      <div id="alerts-preview-container" class="alerts-preview-container">
        <div id="alerts-preview-content" class="alerts-preview-content">
          <div class="overview-stats">
            <div class="overview-stat" style="border-left-color: #dc2626">
              <span class="overview-stat-count">3</span>
              <span class="overview-stat-label">Critical</span>
            </div>
            <div class="overview-stat" style="border-left-color: #ea580c">
              <span class="overview-stat-count">2</span>
              <span class="overview-stat-label">Serious</span>
            </div>
            <div class="overview-stat" style="border-left-color: #facc15">
              <span class="overview-stat-count">5</span>
              <span class="overview-stat-label">Moderate</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Split button below blurred alerts -->
      <div class="alerts-action-container">
        <div class="split-button-container">
          <div class="report-button-group overlay-split-group">
            <button
              id="overlay-primary-report-btn"
              class="btn btn-primary report-main-btn component-create-report"
              data-origin="alerts-overlay"
            >
              <span class="button-icon" data-icon="plus" aria-hidden="true"
                >+</span
              >
              <span class="btn-label">Create Report</span>
            </button>
            <button
              id="overlay-report-dropdown-btn"
              class="btn btn-primary report-dropdown-btn dropdown-toggle"
              aria-label="Report options"
              aria-expanded="false"
              aria-haspopup="menu"
            >
              <span class="dropdown-icon">â–¼</span>
            </button>
          </div>
          <!-- Dropdown menu positioned outside the button group -->
          <div
            id="overlay-report-dropdown"
            class="dropdown-menu"
            role="menu"
            hidden
          >
            <ul>
              <li>
                <button class="dropdown-item" role="menuitem">
                  New Report
                </button>
              </li>
              <li>
                <button class="dropdown-item" role="menuitem">
                  Add to Existing Report
                </button>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Simple demo script to show/hide dropdown
      document.addEventListener("DOMContentLoaded", function () {
        const dropdownBtn = document.getElementById(
          "overlay-report-dropdown-btn"
        );
        const dropdownMenu = document.getElementById("overlay-report-dropdown");

        dropdownBtn.addEventListener("click", function () {
          const isOpen = dropdownBtn.getAttribute("aria-expanded") === "true";

          if (isOpen) {
            // Close menu
            dropdownBtn.setAttribute("aria-expanded", "false");
            dropdownMenu.setAttribute("hidden", "");
            dropdownMenu.setAttribute("aria-hidden", "true");
          } else {
            // Open menu
            dropdownBtn.setAttribute("aria-expanded", "true");
            dropdownMenu.removeAttribute("hidden");
            dropdownMenu.setAttribute("aria-hidden", "false");
          }
        });

        // Close menu when clicking outside
        document.addEventListener("click", function (e) {
          if (!e.target.closest(".split-button-container")) {
            dropdownBtn.setAttribute("aria-expanded", "false");
            dropdownMenu.setAttribute("hidden", "");
            dropdownMenu.setAttribute("aria-hidden", "true");
          }
        });

        // Handle menu item clicks
        document.querySelectorAll(".dropdown-item").forEach((item) => {
          item.addEventListener("click", function () {
            alert("Selected: " + this.textContent);
            // Close menu
            dropdownBtn.setAttribute("aria-expanded", "false");
            dropdownMenu.setAttribute("hidden", "");
            dropdownMenu.setAttribute("aria-hidden", "true");
          });
        });
      });
    </script>
  </body>
</html>
